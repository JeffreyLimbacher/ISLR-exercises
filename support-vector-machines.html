<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Jeffrey’s Answers to the ISLR Exercises</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.6.2 and GitBook 2.6.7">

  <meta property="og:title" content="Jeffrey’s Answers to the ISLR Exercises" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/ISLR-exercises" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Jeffrey’s Answers to the ISLR Exercises" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Jeffrey Limbacher">


<meta name="date" content="2018-02-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chap8.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> Classification</a></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> Linear Model Selection and Regularization</a></li>
<li class="chapter" data-level="7" data-path="chap7.html"><a href="chap7.html"><i class="fa fa-check"></i><b>7</b> Moving Beyond Linearity</a></li>
<li class="chapter" data-level="8" data-path="chap8.html"><a href="chap8.html"><i class="fa fa-check"></i><b>8</b> Moving Beyond Linearity</a></li>
<li class="chapter" data-level="9" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>9</b> Support Vector Machines</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Jeffrey’s Answers to the ISLR Exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="support-vector-machines" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Support Vector Machines</h1>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dt">by=</span>.<span class="dv">01</span>)
x2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>x1
<span class="kw">plot</span>(x1,x2,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">8</span>))
<span class="kw">polygon</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">y=</span><span class="kw">c</span>(x2[<span class="dv">1</span>],<span class="dv">10</span>,<span class="dv">10</span>,x2[<span class="kw">length</span>(x2)]),<span class="dt">density=</span><span class="ot">NA</span>,<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))
<span class="kw">text</span>(<span class="dt">x=</span>.<span class="dv">5</span>,<span class="dt">y=</span><span class="dv">6</span>,<span class="st">&quot;1 + 3 x1 - x2 &lt; 0&quot;</span>)
<span class="kw">text</span>(<span class="dt">x=</span>.<span class="dv">5</span>,<span class="dt">y=</span><span class="op">-</span><span class="dv">1</span>,<span class="st">&quot;1 +3 x1 - x2 &gt; 0&quot;</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-246-1.png" width="672" />
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span><span class="op">*</span>x1
<span class="kw">plot</span>(x1,x2,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">polygon</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">y=</span><span class="kw">c</span>(x2[<span class="dv">1</span>],<span class="dv">10</span>,<span class="dv">10</span>,x2[<span class="kw">length</span>(x2)]),<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))
<span class="kw">text</span>(<span class="dt">x=</span>.<span class="dv">5</span>,<span class="dt">y=</span><span class="fl">1.5</span>,<span class="st">&quot;-2 + x1 + 2 x2 &gt; 0&quot;</span>)
<span class="kw">text</span>(<span class="dt">x=</span>.<span class="dv">5</span>,<span class="dt">y=</span><span class="dv">0</span>,<span class="st">&quot;-2 + x1 + 2 x2 &lt; 0&quot;</span>)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p></li>
<li><ol style="list-style-type: lower-alpha">
<li>This is the equation of a circle centered at (-1,2) with radius 2.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>) <span class="co">#set plot to be square so we don&#39;t distort the circle.</span>
<span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">2</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x1&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x2&quot;</span>)
x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="dt">by=</span>.<span class="dv">01</span>)
y &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">-</span>(x<span class="op">+</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)
xrev &lt;-<span class="st"> </span>x[<span class="kw">length</span>(x)<span class="op">:</span><span class="dv">1</span>]
yrev &lt;-<span class="st"> </span>y[<span class="kw">length</span>(y)<span class="op">:</span><span class="dv">1</span>]
<span class="kw">polygon</span>(<span class="kw">c</span>(x,xrev),<span class="kw">c</span>(y<span class="op">+</span><span class="dv">2</span>,<span class="op">-</span>yrev<span class="op">+</span><span class="dv">2</span>))</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-248-1.png" width="672" />
<ol start="2" style="list-style-type: lower-alpha">
<li>The points <span class="math inline">\((1+X_1)^2 + (2-X_2)^2 \leq 4\)</span> are inside the circle.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xrev &lt;-<span class="st"> </span>x[<span class="kw">length</span>(x)<span class="op">:</span><span class="dv">1</span>]
yrev &lt;-<span class="st"> </span>y[<span class="kw">length</span>(y)<span class="op">:</span><span class="dv">1</span>]
<span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>) <span class="co">#set plot to be square so we don&#39;t distort the circle.</span>
<span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">2</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x1&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x2&quot;</span>)
<span class="kw">rect</span>(<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">5</span>)) <span class="co">#Outside the circle is blue for part c</span>
<span class="kw">polygon</span>(<span class="kw">c</span>(x,xrev),<span class="kw">c</span>(y<span class="op">+</span><span class="dv">2</span>,<span class="op">-</span>yrev<span class="op">+</span><span class="dv">2</span>),<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))
<span class="kw">text</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">y=</span><span class="dv">2</span>,<span class="st">&quot;(1+X_1)^2+(2-X_2)^2&lt;=4&quot;</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-249-1.png" width="672" />
<ol start="3" style="list-style-type: lower-alpha">
<li><span class="math inline">\((0,0)\)</span> is blue, <span class="math inline">\((-1,1)\)</span> is red, <span class="math inline">\((2,2)\)</span> is blue, <span class="math inline">\((3,8)\)</span> is blue.</li>
<li>If we expand the quadratic terms, we can see this,
<span class="math display">\[\begin{equation}
(1+X_1)^2 + (2-X_2)^2 = 1 + 2X_1 + X_1^2 + 2 - 4X_2 + X_2^2
\end{equation}\]</span></li>
</ol></li>
<li><ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat&lt;-<span class="kw">data.frame</span>(
  <span class="dt">x1=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>),
  <span class="dt">x2=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),
  <span class="dt">y =</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">length.out=</span><span class="dv">7</span>,<span class="dt">each=</span><span class="dv">4</span>)
)
<span class="kw">plot</span>(dat<span class="op">$</span>x1,dat<span class="op">$</span>x2,<span class="dt">col=</span><span class="kw">as.character</span>(dat<span class="op">$</span>y))</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-250-1.png" width="672" />
<ol start="2" style="list-style-type: lower-alpha">
<li>The optimal hyperplane goes through (2,1.5) and (4,3.5). Using linear equations then the equation for the hyperplane becomes <span class="math inline">\(-0.5+X_1-X_2=0\)</span>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dat<span class="op">$</span>x1,dat<span class="op">$</span>x2,<span class="dt">col=</span><span class="kw">as.character</span>(dat<span class="op">$</span>y))
<span class="kw">abline</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-251-1.png" width="672" />
<ol start="3" style="list-style-type: lower-alpha">
<li>We would classify as red if <span class="math inline">\(-0.5+X_1-X_2&lt;0\)</span> and blue otherwise. The values the <span class="math inline">\(\beta\)</span>’s are <span class="math inline">\(\beta_0=-0.5\)</span>, <span class="math inline">\(\beta_1=1\)</span>, and <span class="math inline">\(\beta_2=-1\)</span>.</li>
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dat<span class="op">$</span>x1,dat<span class="op">$</span>x2,<span class="dt">col=</span><span class="kw">as.character</span>(dat<span class="op">$</span>y))
<span class="kw">abline</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">text</span>(<span class="fl">3.9</span>,<span class="fl">3.6</span>,<span class="st">&quot;M=1&quot;</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-252-1.png" width="672" />
<ol start="5" style="list-style-type: lower-alpha">
<li>See the last plot.</li>
<li>The seventh obsevation is in the bottom right so it’s far from the hyperplane.</li>
<li>We can have a line go through the bottom most red observation and the top most blue observation. This is a worst case hyperplane. The equation of this would be <span class="math inline">\(1 + .5X_1 - X_2 = 0\)</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dat<span class="op">$</span>x1,dat<span class="op">$</span>x2,<span class="dt">col=</span><span class="kw">as.character</span>(dat<span class="op">$</span>y))
<span class="kw">abline</span>(<span class="dv">1</span>,.<span class="dv">5</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-253-1.png" width="672" />
<ol start="8" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(dat,<span class="kw">c</span>(<span class="dv">2</span>,<span class="fl">2.5</span>,<span class="st">&quot;blue&quot;</span>))
<span class="kw">with</span>(dat2,<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span><span class="kw">as.character</span>(y)))</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p></li>
<li><p>I use a cubic polynomial to separate the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">sort</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">2</span>))
y&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>)
f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">1.5</span><span class="op">*</span>(x)<span class="op">*</span>(x<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(x<span class="op">-</span><span class="dv">3</span>)
labs&lt;-<span class="kw">factor</span>(<span class="kw">ifelse</span>(y<span class="op">&gt;</span><span class="kw">f</span>(x),<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>))
<span class="kw">plot</span>(x,y,<span class="dt">col=</span>labs)
<span class="kw">lines</span>(x,<span class="kw">f</span>(x))</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-255-1.png" width="672" /> Now to classify with SVM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(e1071)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
train&lt;-<span class="kw">sample.int</span>(<span class="dv">100</span>,<span class="dv">80</span>)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,labs)
(poly.tune&lt;-<span class="kw">tune</span>(svm,labs<span class="op">~</span>.,<span class="dt">data=</span>dat[train,],<span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>,<span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">d=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">cost=</span><span class="kw">c</span>(.<span class="dv">001</span>,.<span class="dv">01</span>,.<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>))))</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  d cost
##  3    1
## 
## - best performance: 0.175</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
(exp.tune &lt;-<span class="kw">tune</span>(svm,labs<span class="op">~</span>.,<span class="dt">data=</span>dat[train,],<span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>,<span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">gamma=</span><span class="kw">c</span>(.<span class="dv">01</span>,.<span class="dv">05</span>,.<span class="dv">1</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">cost=</span><span class="kw">c</span>(.<span class="dv">001</span>,.<span class="dv">01</span>,.<span class="dv">1</span>,<span class="dv">10</span>))))</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  gamma cost
##      1   10
## 
## - best performance: 0.15</code></pre>
<p>Now we test the best poly versus the best radial on the test set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poly.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(labs<span class="op">~</span>.,<span class="dt">data=</span>dat[train,],<span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>,<span class="dt">d=</span>poly.tune<span class="op">$</span>best.parameters<span class="op">$</span>d,<span class="dt">cost=</span>poly.tune<span class="op">$</span>best.parameters<span class="op">$</span>cost)
exp.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(labs<span class="op">~</span>.,<span class="dt">data=</span>dat[train,],<span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>,<span class="dt">gamma=</span>exp.tune<span class="op">$</span>best.parameters<span class="op">$</span>gamma,<span class="dt">cost=</span>exp.tune<span class="op">$</span>best.parameters<span class="op">$</span>cost)
<span class="kw">library</span>(ROCR)</code></pre></div>
<pre><code>## Loading required package: gplots</code></pre>
<pre><code>## 
## Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     lowess</code></pre>
<pre><code>## Loading required package: methods</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rocplot=<span class="cf">function</span>(pred, truth, ...){
  predob =<span class="st"> </span><span class="kw">prediction</span>(pred, truth)
  perf =<span class="st"> </span><span class="kw">performance</span>(predob , <span class="st">&quot;tpr&quot;</span>, <span class="st">&quot;fpr&quot;</span>)
  <span class="kw">plot</span>(perf,...)
}
fitted=<span class="kw">attributes</span>(<span class="kw">predict</span>(poly.mod,dat[<span class="op">-</span>train,],<span class="dt">decision.values=</span>T))<span class="op">$</span>decision.values
<span class="kw">rocplot</span>(<span class="op">-</span>fitted,dat[<span class="op">-</span>train,<span class="st">&quot;labs&quot;</span>],<span class="dt">main=</span><span class="st">&quot;Test Data&quot;</span>) <span class="co">#for some reason, I have to make the </span>
<span class="co">#fitted values negative for the ROC curve to display correctly.</span>
fitted=<span class="kw">attributes</span>(<span class="kw">predict</span>(exp.mod,dat[<span class="op">-</span>train,],<span class="dt">decision.values=</span>T))<span class="op">$</span>decision.values
<span class="kw">rocplot</span>(<span class="op">-</span>fitted,dat[<span class="op">-</span>train,<span class="st">&quot;labs&quot;</span>],<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-258-1.png" width="672" /> The ROC curve tells us that the radial kernel works best. The tables below show how the final models classified. They ended up performing just as well as each other on the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poly.fit=<span class="kw">predict</span>(poly.mod,dat[<span class="op">-</span>train,])
<span class="kw">table</span>(poly.fit,dat[<span class="op">-</span>train,]<span class="op">$</span>labs)</code></pre></div>
<pre><code>##         
## poly.fit black red
##    black     9   2
##    red       1   8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp.fit=<span class="kw">predict</span>(poly.mod,dat[<span class="op">-</span>train,])
<span class="kw">table</span>(exp.fit,dat[<span class="op">-</span>train,]<span class="op">$</span>labs)</code></pre></div>
<pre><code>##        
## exp.fit black red
##   black     9   2
##   red       1   8</code></pre></li>
<li><ol style="list-style-type: lower-alpha">
<li>I will copy their example.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">927</span>)
x1&lt;-<span class="kw">runif</span>(<span class="dv">500</span>)<span class="op">-</span><span class="fl">0.5</span>
x2&lt;-<span class="kw">runif</span>(<span class="dv">500</span>)<span class="op">-</span><span class="fl">0.5</span>
yn &lt;-<span class="st"> </span>(x1<span class="op">^</span><span class="dv">2</span><span class="op">-</span>x2<span class="op">^</span><span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="op">*</span><span class="dv">1</span>
y&lt;-<span class="kw">factor</span>(yn)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y,x1,x2)</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>yn<span class="op">+</span><span class="dv">1</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-262-1.png" width="672" />
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log.mod &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>x1<span class="op">+</span>x2,<span class="dt">family=</span>binomial,<span class="dt">data=</span>dat)</code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y.pred&lt;-<span class="kw">predict</span>(log.mod,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
y.pred&lt;-<span class="dv">1</span><span class="op">*</span>(y.pred<span class="op">&gt;</span>.<span class="dv">5</span>)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>y.pred<span class="op">+</span><span class="dv">1</span>)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-264-1.png" width="672" /> Note that not a single value was predicted to be 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">any</span>(<span class="kw">predict</span>(log.mod,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&lt;</span>.<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log.nl.mod &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x1,<span class="dt">d=</span><span class="dv">3</span>)<span class="op">*</span><span class="kw">poly</span>(x2,<span class="dt">d=</span><span class="dv">3</span>),<span class="dt">family=</span>binomial)</code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(log.nl.mod)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ poly(x1, d = 3) * poly(x2, d = 3), family = binomial)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
##  -8.49    0.00    0.00    0.00    0.00  
## 
## Coefficients:
##                                     Estimate Std. Error    z value
## (Intercept)                        4.255e+14  3.020e+06  140857273
## poly(x1, d = 3)1                   5.289e+15  6.772e+07   78097144
## poly(x1, d = 3)2                   3.877e+16  6.783e+07  571602809
## poly(x1, d = 3)3                   6.228e+15  6.772e+07   91976090
## poly(x2, d = 3)1                  -5.832e+14  6.782e+07   -8599865
## poly(x2, d = 3)2                  -4.425e+16  6.806e+07 -650251173
## poly(x2, d = 3)3                   1.326e+15  6.807e+07   19473864
## poly(x1, d = 3)1:poly(x2, d = 3)1 -5.205e+16  1.541e+09  -33780291
## poly(x1, d = 3)2:poly(x2, d = 3)1 -1.357e+16  1.563e+09   -8683002
## poly(x1, d = 3)3:poly(x2, d = 3)1 -1.616e+17  1.567e+09 -103123323
## poly(x1, d = 3)1:poly(x2, d = 3)2 -1.575e+17  1.544e+09 -101992263
## poly(x1, d = 3)2:poly(x2, d = 3)2  1.608e+17  1.527e+09  105303315
## poly(x1, d = 3)3:poly(x2, d = 3)2  4.657e+15  1.577e+09    2952770
## poly(x1, d = 3)1:poly(x2, d = 3)3  4.136e+16  1.554e+09   26619396
## poly(x1, d = 3)2:poly(x2, d = 3)3 -3.706e+16  1.572e+09  -23575777
## poly(x1, d = 3)3:poly(x2, d = 3)3 -4.545e+16  1.581e+09  -28749642
##                                   Pr(&gt;|z|)    
## (Intercept)                         &lt;2e-16 ***
## poly(x1, d = 3)1                    &lt;2e-16 ***
## poly(x1, d = 3)2                    &lt;2e-16 ***
## poly(x1, d = 3)3                    &lt;2e-16 ***
## poly(x2, d = 3)1                    &lt;2e-16 ***
## poly(x2, d = 3)2                    &lt;2e-16 ***
## poly(x2, d = 3)3                    &lt;2e-16 ***
## poly(x1, d = 3)1:poly(x2, d = 3)1   &lt;2e-16 ***
## poly(x1, d = 3)2:poly(x2, d = 3)1   &lt;2e-16 ***
## poly(x1, d = 3)3:poly(x2, d = 3)1   &lt;2e-16 ***
## poly(x1, d = 3)1:poly(x2, d = 3)2   &lt;2e-16 ***
## poly(x1, d = 3)2:poly(x2, d = 3)2   &lt;2e-16 ***
## poly(x1, d = 3)3:poly(x2, d = 3)2   &lt;2e-16 ***
## poly(x1, d = 3)1:poly(x2, d = 3)3   &lt;2e-16 ***
## poly(x1, d = 3)2:poly(x2, d = 3)3   &lt;2e-16 ***
## poly(x1, d = 3)3:poly(x2, d = 3)3   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance:  689.27  on 499  degrees of freedom
## Residual deviance: 3460.19  on 484  degrees of freedom
## AIC: 3492.2
## 
## Number of Fisher Scoring iterations: 24</code></pre>
Logistic regression does poorly at capturing the model.
<ol start="6" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y.pred&lt;-<span class="kw">predict</span>(log.nl.mod,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
y.pred&lt;-<span class="dv">1</span><span class="op">*</span>(y.pred<span class="op">&gt;</span>.<span class="dv">5</span>)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>y.pred<span class="op">+</span><span class="dv">1</span>)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-267-1.png" width="672" /> Looks better, but there is still misclassification.
<ol start="7" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.lin.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>dat, <span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>)
svm.lin.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.lin.mod)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>svm.lin.pred)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-268-1.png" width="672" />
<ol start="8" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>dat, <span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="dt">d=</span><span class="dv">3</span>, <span class="dt">cost=</span><span class="dv">1</span>)
svm.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.mod)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>svm.pred)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-269-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>dat, <span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="dt">cost=</span><span class="dv">1</span>)
svm.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.mod)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>svm.pred)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.trn.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(y<span class="op">~</span><span class="kw">poly</span>(x1,<span class="dt">d=</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">poly</span>(x2,<span class="dt">d=</span><span class="dv">2</span>),<span class="dt">data=</span>dat,<span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>)
svm.trn.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.trn.mod)
<span class="kw">plot</span>(x1,x2,<span class="dt">col=</span>svm.trn.pred)</code></pre></div>
<img src="ISLR-exercises_files/figure-html/unnamed-chunk-271-1.png" width="672" />
<ol style="list-style-type: lower-roman">
<li>The SvM with the transformed predictors and linear kernel seems to do the best.</li>
</ol></li>
<li><ol style="list-style-type: lower-alpha">
<li><ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol></li>
</ul></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">927</span>)
n&lt;-<span class="dv">50</span>
x&lt;-<span class="kw">matrix</span>(<span class="kw">runif</span>(n<span class="op">*</span><span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">2</span>)
y&lt;-<span class="kw">factor</span>(x[,<span class="dv">2</span>]<span class="op">&gt;</span>x[,<span class="dv">1</span>])
dat&lt;-<span class="kw">data.frame</span>(x,y)
costs &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="dt">by=</span>.<span class="dv">5</span>))
res&lt;-<span class="kw">tune</span>(svm,y<span class="op">~</span>X1<span class="op">+</span>X2,<span class="dt">data=</span>dat,<span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>,<span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">cost=</span>costs))
<span class="kw">summary</span>(res)</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  cost
##     1
## 
## - best performance: 0 
## 
## - Detailed performance results:
##            cost error dispersion
## 1  1.000000e-03  0.44 0.24585452
## 2  3.162278e-03  0.44 0.24585452
## 3  1.000000e-02  0.44 0.24585452
## 4  3.162278e-02  0.14 0.18973666
## 5  1.000000e-01  0.12 0.13984118
## 6  3.162278e-01  0.08 0.13984118
## 7  1.000000e+00  0.00 0.00000000
## 8  3.162278e+00  0.02 0.06324555
## 9  1.000000e+01  0.00 0.00000000
## 10 3.162278e+01  0.00 0.00000000
## 11 1.000000e+02  0.00 0.00000000
## 12 3.162278e+02  0.00 0.00000000
## 13 1.000000e+03  0.00 0.00000000</code></pre>
The best cost is 1.
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
best.cost &lt;-<span class="st"> </span>res<span class="op">$</span>best.parameters<span class="op">$</span>cost
test.x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">10</span><span class="op">*</span>n<span class="op">*</span><span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">2</span>)
test.y&lt;-<span class="kw">factor</span>(test.x[,<span class="dv">2</span>]<span class="op">&gt;</span>test.x[,<span class="dv">1</span>])
test.dat&lt;-<span class="kw">data.frame</span>(test.x,<span class="dt">y=</span>test.y)
cost.performances &lt;-<span class="st"> </span><span class="kw">double</span>(<span class="kw">length</span>(costs))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(costs))
{
  c &lt;-<span class="st"> </span>costs[i]
  svm.mod &lt;-<span class="st"> </span><span class="kw">svm</span>(y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">data=</span>dat, <span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>,<span class="dt">cost=</span>c)
  pred.y &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.mod,test.dat)
  cost.performances[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pred.y<span class="op">==</span>test.y)
}
<span class="kw">cbind</span>(costs,cost.performances)</code></pre></div>
<pre><code>##              costs cost.performances
##  [1,] 1.000000e-03             0.516
##  [2,] 3.162278e-03             0.516
##  [3,] 1.000000e-02             0.516
##  [4,] 3.162278e-02             0.846
##  [5,] 1.000000e-01             0.872
##  [6,] 3.162278e-01             0.928
##  [7,] 1.000000e+00             0.958
##  [8,] 3.162278e+00             0.968
##  [9,] 1.000000e+01             0.978
## [10,] 3.162278e+01             0.986
## [11,] 1.000000e+02             0.986
## [12,] 3.162278e+02             0.986
## [13,] 1.000000e+03             0.986</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol></li>
<li><ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Auto,<span class="dt">package=</span><span class="st">&quot;ISLR&quot;</span>)
Auto<span class="op">$</span>mpg01 &lt;-<span class="st"> </span><span class="kw">with</span>(Auto,<span class="kw">factor</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="kw">median</span>(mpg)))</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
costs &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="dt">by=</span>.<span class="dv">5</span>))
lin.res &lt;-<span class="st"> </span><span class="kw">tune</span>(svm, mpg01 <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Auto, <span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">cost=</span>costs), <span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>)
lin.res</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  cost
##     1
## 
## - best performance: 0.01275641</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2</span>)
gammas &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dt">by=</span><span class="dv">1</span>))
costs2 &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dt">by=</span><span class="dv">1</span>))
rad.res &lt;-<span class="st"> </span><span class="kw">tune</span>(svm, mpg01 <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Auto, <span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">cost=</span>costs,<span class="dt">gamma=</span>gammas),<span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>)
<span class="kw">summary</span>(rad.res)</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##      cost gamma
##  316.2278 0.001
## 
## - best performance: 0.007628205 
## 
## - Detailed performance results:
##            cost gamma       error dispersion
## 1  1.000000e-02 0.001 0.561089744 0.05185229
## 2  3.162278e-02 0.001 0.561089744 0.05185229
## 3  1.000000e-01 0.001 0.530384615 0.07484076
## 4  3.162278e-01 0.001 0.099487179 0.04398264
## 5  1.000000e+00 0.001 0.091794872 0.05118295
## 6  3.162278e+00 0.001 0.076538462 0.04000717
## 7  1.000000e+01 0.001 0.068910256 0.03816032
## 8  3.162278e+01 0.001 0.053525641 0.03480644
## 9  1.000000e+02 0.001 0.022948718 0.01890223
## 10 3.162278e+02 0.001 0.007628205 0.01228382
## 11 1.000000e+03 0.001 0.015320513 0.01318724
## 12 3.162278e+03 0.001 0.020384615 0.01594939
## 13 1.000000e+04 0.001 0.035705128 0.02442271
## 14 1.000000e-02 0.010 0.561089744 0.05185229
## 15 3.162278e-02 0.010 0.099487179 0.05018848
## 16 1.000000e-01 0.010 0.089230769 0.04828946
## 17 3.162278e-01 0.010 0.079102564 0.03507425
## 18 1.000000e+00 0.010 0.073974359 0.03703948
## 19 3.162278e+00 0.010 0.053525641 0.03480644
## 20 1.000000e+01 0.010 0.023012821 0.01891104
## 21 3.162278e+01 0.010 0.017820513 0.02088734
## 22 1.000000e+02 0.010 0.017884615 0.01234314
## 23 3.162278e+02 0.010 0.022948718 0.01871043
## 24 1.000000e+03 0.010 0.025512821 0.02076457
## 25 3.162278e+03 0.010 0.025512821 0.02076457
## 26 1.000000e+04 0.010 0.025512821 0.02076457
## 27 1.000000e-02 0.100 0.239679487 0.05626150
## 28 3.162278e-02 0.100 0.081602564 0.03753398
## 29 1.000000e-01 0.100 0.076538462 0.03187731
## 30 3.162278e-01 0.100 0.068910256 0.03619541
## 31 1.000000e+00 0.100 0.053589744 0.03060885
## 32 3.162278e+00 0.100 0.028141026 0.02550614
## 33 1.000000e+01 0.100 0.028141026 0.03070454
## 34 3.162278e+01 0.100 0.033269231 0.03833365
## 35 1.000000e+02 0.100 0.035833333 0.03862318
## 36 3.162278e+02 0.100 0.035833333 0.03862318
## 37 1.000000e+03 0.100 0.035833333 0.03862318
## 38 3.162278e+03 0.100 0.035833333 0.03862318
## 39 1.000000e+04 0.100 0.035833333 0.03862318</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">3</span>)
poly.res &lt;-<span class="st"> </span><span class="kw">tune</span>(svm, mpg01 <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Auto, <span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">cost=</span>costs,<span class="dt">d=</span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>),<span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>)
<span class="kw">summary</span>(poly.res)</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##   cost d
##  10000 3
## 
## - best performance: 0.08903846 
## 
## - Detailed performance results:
##            cost d      error dispersion
## 1  1.000000e-02 2 0.56333333 0.05501778
## 2  3.162278e-02 2 0.56333333 0.05501778
## 3  1.000000e-01 2 0.56333333 0.05501778
## 4  3.162278e-01 2 0.56333333 0.05501778
## 5  1.000000e+00 2 0.56333333 0.05501778
## 6  3.162278e+00 2 0.56333333 0.05501778
## 7  1.000000e+01 2 0.49935897 0.13927297
## 8  3.162278e+01 2 0.38442308 0.09577897
## 9  1.000000e+02 2 0.29301282 0.09219705
## 10 3.162278e+02 2 0.30865385 0.09147957
## 11 1.000000e+03 2 0.21647436 0.09448024
## 12 3.162278e+03 2 0.15557692 0.06591321
## 13 1.000000e+04 2 0.14532051 0.07471306
## 14 1.000000e-02 3 0.56333333 0.05501778
## 15 3.162278e-02 3 0.56333333 0.05501778
## 16 1.000000e-01 3 0.56333333 0.05501778
## 17 3.162278e-01 3 0.56333333 0.05501778
## 18 1.000000e+00 3 0.56333333 0.05501778
## 19 3.162278e+00 3 0.56333333 0.05501778
## 20 1.000000e+01 3 0.56333333 0.05501778
## 21 3.162278e+01 3 0.51467949 0.10767554
## 22 1.000000e+02 3 0.34083333 0.11384621
## 23 3.162278e+02 3 0.27000000 0.09019716
## 24 1.000000e+03 3 0.25480769 0.08064661
## 25 3.162278e+03 3 0.23942308 0.08048794
## 26 1.000000e+04 3 0.08903846 0.06849379
## 27 1.000000e-02 4 0.56333333 0.05501778
## 28 3.162278e-02 4 0.56333333 0.05501778
## 29 1.000000e-01 4 0.56333333 0.05501778
## 30 3.162278e-01 4 0.56333333 0.05501778
## 31 1.000000e+00 4 0.56333333 0.05501778
## 32 3.162278e+00 4 0.56333333 0.05501778
## 33 1.000000e+01 4 0.56333333 0.05501778
## 34 3.162278e+01 4 0.56333333 0.05501778
## 35 1.000000e+02 4 0.56333333 0.05501778
## 36 3.162278e+02 4 0.56333333 0.05501778
## 37 1.000000e+03 4 0.51724359 0.12131501
## 38 3.162278e+03 4 0.47891026 0.08470192
## 39 1.000000e+04 4 0.41250000 0.08952316</code></pre>
The error was 0.0101.
<ol start="4" style="list-style-type: lower-alpha">
<li>We know that the mpg varies a lot with weight and acceleration.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.lin &lt;-<span class="st"> </span>lin.res<span class="op">$</span>best.model
<span class="kw">plot</span>(svm.lin, Auto, weight <span class="op">~</span><span class="st"> </span>displacement)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-278-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.rad &lt;-<span class="st"> </span>rad.res<span class="op">$</span>best.model
<span class="kw">plot</span>(svm.rad, Auto, weight <span class="op">~</span><span class="st"> </span>displacement)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-278-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm.poly &lt;-<span class="st"> </span>poly.res<span class="op">$</span>best.model
<span class="kw">plot</span>(svm.poly, Auto, weight <span class="op">~</span><span class="st"> </span>displacement)</code></pre></div>
<p><img src="ISLR-exercises_files/figure-html/unnamed-chunk-278-3.png" width="672" /> We can see that</p></li>
<li><ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(OJ,<span class="dt">package=</span><span class="st">&quot;ISLR&quot;</span>)
<span class="kw">set.seed</span>(<span class="dv">927</span>)
train &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="kw">nrow</span>(OJ), <span class="dt">size=</span><span class="dv">800</span>)</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(e1071)
svm.class &lt;-<span class="st"> </span><span class="kw">svm</span>(Purchase <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>OJ[train,], <span class="dt">cost=</span><span class="fl">0.01</span>, <span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>)
<span class="kw">summary</span>(svm.class)</code></pre></div>
<pre><code>## 
## Call:
## svm(formula = Purchase ~ ., data = OJ[train, ], cost = 0.01, 
##     kernel = &quot;linear&quot;)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  linear 
##        cost:  0.01 
##       gamma:  0.05555556 
## 
## Number of Support Vectors:  441
## 
##  ( 220 221 )
## 
## 
## Number of Classes:  2 
## 
## Levels: 
##  CH MM</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Training error</span>
class.train.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.class)
pur.train &lt;-<span class="st"> </span>OJ[train,<span class="st">&quot;Purchase&quot;</span>]
(class.train.err &lt;-<span class="st"> </span><span class="kw">mean</span>(pur.train <span class="op">!=</span><span class="st"> </span>class.train.pred))</code></pre></div>
<pre><code>## [1] 0.16875</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Test error</span>
class.test.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.class, OJ[<span class="op">-</span>train,])
pur.test &lt;-<span class="st"> </span>OJ[<span class="op">-</span>train,<span class="st">&quot;Purchase&quot;</span>]
(class.test.err &lt;-<span class="st"> </span><span class="kw">mean</span>(pur.test <span class="op">!=</span><span class="st"> </span>class.test.pred))</code></pre></div>
<pre><code>## [1] 0.1407407</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">927</span>)
costs&lt;-<span class="dv">10</span><span class="op">^</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dt">by=</span>.<span class="dv">25</span>)
class.res &lt;-<span class="st"> </span><span class="kw">tune</span>(svm, Purchase <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>OJ[train,], <span class="dt">ranges=</span><span class="kw">list</span>(<span class="dt">cost=</span>costs), <span class="dt">kernel=</span><span class="st">&quot;linear&quot;</span>)
<span class="kw">summary</span>(class.res)</code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##       cost
##  0.5623413
## 
## - best performance: 0.17125 
## 
## - Detailed performance results:
##            cost   error dispersion
## 1    0.01000000 0.18000 0.05244044
## 2    0.01778279 0.18125 0.05212498
## 3    0.03162278 0.17875 0.05714565
## 4    0.05623413 0.17750 0.05130248
## 5    0.10000000 0.17625 0.05478810
## 6    0.17782794 0.17250 0.05614960
## 7    0.31622777 0.17250 0.05329426
## 8    0.56234133 0.17125 0.05497790
## 9    1.00000000 0.17250 0.05886661
## 10   1.77827941 0.17250 0.05676462
## 11   3.16227766 0.17250 0.05583955
## 12   5.62341325 0.17500 0.05368374
## 13  10.00000000 0.17750 0.05394184
## 14  17.78279410 0.17750 0.05521423
## 15  31.62277660 0.17625 0.05084358
## 16  56.23413252 0.17750 0.05096295
## 17 100.00000000 0.17875 0.05104804</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Training error</span>
<span class="co">#svm.best.class &lt;- svm(Purchase ~ ., data=OJ[train,], cost=class.res$best.parameters$cost, kernel=&quot;linear&quot;)</span>
svm.best.class &lt;-<span class="st"> </span>class.res<span class="op">$</span>best.model
svm.best.class.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.best.class)
(best.class.train.err &lt;-<span class="st"> </span><span class="kw">mean</span>(pur.train <span class="op">!=</span><span class="st"> </span>svm.best.class.pred))</code></pre></div>
<pre><code>## [1] 0.1675</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Test error</span>
svm.best.class.test &lt;-<span class="st"> </span><span class="kw">predict</span>(svm.best.class, OJ[<span class="op">-</span>train,])
(best.class.test.err &lt;-<span class="st"> </span><span class="kw">mean</span>(pur.test <span class="op">!=</span><span class="st"> </span>svm.best.class.test))</code></pre></div>
<pre><code>## [1] 0.162963</code></pre></li>
</ol>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap8.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["ISLR-exercises.pdf", "ISLR-exercises.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
